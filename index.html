<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jadwal Sholat Masjid Aisyah</title>
<link href="https://fonts.googleapis.com/css2?family=DSEG7+Classic&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* CSS UTAMA UNTUK RESPONSIVE DESIGN */

/* Reset dan base styles */
* {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: Arial, sans-serif;
    color: #FF7A00;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Container utama */
.main-container {
    background: rgba(0, 0, 0, 0.184);
    min-height: 100vh;
    padding: 20px;
    position: relative;
}

/* HEADER STYLES */
nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    padding: 0 20px;
    background: transparent;
}

.header-inner {
    background: #2C2C2BE5;
    border-radius: 0 0 30px 30px;
    padding: 15px 40px;
    max-width: 1600px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.6);
}

.info-masjid {
    display: flex;
    align-items: center;
    gap: 14px;
}

.info-masjid h2 {
    margin: 0;
    color: white;
    font-size: 40px;
    font-weight: bold;
}

.info-masjid small {
    color: white;
    font-size: 15px;
}

.info-masjid i {
    font-size: 50px;
    color: white;
    margin: 6px;
}

.jam-container {
    text-align: right;
}

.jam-wrapper {
    display: inline-block;
    text-align: center;
}

#jam {
    margin-top: 5px;
    font-family: 'DSEG7 Classic', monospace;
    font-size: 36px;
    color: #FF7A00;
    border: 1px solid #FF7A00;
    padding: 6px 14px;
    border-radius: 10px;
    letter-spacing: 2px;
    font-weight: bold;
}

#tanggal {
    margin-top: 6px;
    font-size: 20px;
    color: white;
    font-weight: bold;
}

#hijri {
    margin-top: 4px;
    font-size: 15px;
    color: white;
    font-style: italic;
}

/* COUNTDOWN STYLES */
.countdown-container {
    position: fixed;
    bottom: 200px;
    left: 0;
    right: 0;
    z-index: 998;
    display: flex;
    justify-content: space-between;
    pointer-events: none;
}

.countdown-ramadhan {
    background: #2C2C2BE6;
    color: white;
    padding: 8px 15px 8px 10px;
    font-size: 14px;
    border-radius: 0 12px 12px 0;
    max-width: 45%;
    backdrop-filter: blur(5px);
}

.countdown-sholat {
    background: #FF7A00;
    color: white;
    padding: 8px 10px 8px 15px;
    font-size: 14px;
    border-radius: 12px 0 0 12px;
    max-width: 45%;
    border-right: 3px solid #FF7A00;
    backdrop-filter: blur(5px);
    text-align: right;
}

#ramadhan {
    font-weight: bold;
    font-size: 16px;
    white-space: nowrap;
}

#countSholat {
    font-family: 'DSEG7 Classic', monospace;
    font-size: 18px;
    color: white;
    white-space: nowrap;
}

/* JADWAL SHOLAT GRID */
.jadwal-container {
    position: fixed;
    bottom: 50px;
    left: 12px;
    right: 12px;
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 10px;
    z-index: 998;
}

.jadwal-item {
    background: #2C2C2B;
    padding: 20px;
    text-align: center;
    border-radius: 6px;
    color: white;
    transition: all 0.3s ease;
}

.jadwal-item:first-child {
    border-radius: 25px 6px 6px 25px;
}

.jadwal-item:last-child {
    border-radius: 6px 25px 25px 6px;
}

.jadwal-title {
    font-size: 20px;
    display: block;
    margin-bottom: 10px;
}

.jadwal-time {
    font-family: 'DSEG7 Classic', monospace;
    font-size: 36px;
    color: #FF7A00;
    border: 1px solid #FF7A00;
    padding: 6px 12px;
    display: inline-block;
    border-radius: 10px;
    letter-spacing: 2px;
    margin-top: 10px;
}

/* MARQUEE */
marquee {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 10px 0;
    font-size: 16px;
    font-weight: bold;
    background: #6060609E;
    color: white;
    z-index: 999;
}

/* ========== MEDIA QUERIES UNTUK RESPONSIVE ========== */

/* Tablet (768px - 1024px) */
@media screen and (max-width: 1024px) {
    .header-inner {
        padding: 12px 30px;
        border-radius: 0 0 25px 25px;
    }
    
    .info-masjid h2 {
        font-size: 32px;
    }
    
    .info-masjid small {
        font-size: 14px;
    }
    
    .info-masjid i {
        font-size: 40px;
    }
    
    #jam {
        font-size: 30px;
        padding: 5px 12px;
    }
    
    #tanggal {
        font-size: 18px;
    }
    
    #hijri {
        font-size: 14px;
    }
    
    .countdown-container {
        bottom: 180px;
    }
    
    .jadwal-container {
        grid-template-columns: repeat(3, 1fr);
        bottom: 60px;
        left: 15px;
        right: 15px;
        gap: 12px;
    }
    
    .jadwal-item {
        padding: 18px 15px;
    }
    
    .jadwal-title {
        font-size: 18px;
    }
    
    .jadwal-time {
        font-size: 30px;
        padding: 5px 10px;
    }
}

/* Smartphone Landscape (576px - 768px) */
@media screen and (max-width: 768px) {
    .header-inner {
        flex-direction: column;
        text-align: center;
        gap: 15px;
        padding: 15px 25px;
        border-radius: 0 0 20px 20px;
    }
    
    .info-masjid {
        flex-direction: column;
        gap: 10px;
    }
    
    .info-masjid h2 {
        font-size: 28px;
    }
    
    .info-masjid small {
        font-size: 13px;
    }
    
    .info-masjid i {
        font-size: 35px;
    }
    
    .jam-container {
        text-align: center;
        width: 100%;
    }
    
    #jam {
        font-size: 26px;
        padding: 5px 10px;
    }
    
    #tanggal {
        font-size: 16px;
    }
    
    #hijri {
        font-size: 13px;
    }
    
    .countdown-container {
        bottom: 160px;
        flex-direction: column;
        align-items: center;
        gap: 10px;
    }
    
    .countdown-ramadhan,
    .countdown-sholat {
        max-width: 90%;
        width: 90%;
        border-radius: 12px;
        padding: 10px 20px;
        text-align: center;
    }
    
    .countdown-ramadhan {
        border-radius: 12px;
    }
    
    .countdown-sholat {
        border-radius: 12px;
        text-align: center;
    }
    
    #ramadhan {
        white-space: normal;
        font-size: 15px;
    }
    
    #countSholat {
        white-space: normal;
        font-size: 16px;
    }
    
    .jadwal-container {
        grid-template-columns: repeat(2, 1fr);
        bottom: 70px;
        left: 10px;
        right: 10px;
        gap: 8px;
    }
    
    .jadwal-item {
        padding: 15px 10px;
        border-radius: 10px !important;
    }
    
    .jadwal-title {
        font-size: 16px;
        margin-bottom: 8px;
    }
    
    .jadwal-time {
        font-size: 26px;
        padding: 4px 8px;
        margin-top: 5px;
    }
    
    marquee {
        font-size: 14px;
        padding: 8px 0;
    }
}

/* Smartphone Portrait (max-width: 576px) */
@media screen and (max-width: 576px) {
    .header-inner {
        padding: 12px 20px;
        border-radius: 0 0 15px 15px;
    }
    
    .info-masjid h2 {
        font-size: 22px;
    }
    
    .info-masjid small {
        font-size: 11px;
    }
    
    .info-masjid i {
        font-size: 30px;
    }
    
    #jam {
        font-size: 22px;
        padding: 4px 8px;
    }
    
    #tanggal {
        font-size: 14px;
    }
    
    #hijri {
        font-size: 12px;
    }
    
    .countdown-container {
        bottom: 150px;
        padding: 0 15px;
    }
    
    .countdown-ramadhan,
    .countdown-sholat {
        width: 100%;
        max-width: 100%;
        padding: 8px 15px;
    }
    
    #ramadhan {
        font-size: 14px;
    }
    
    #countSholat {
        font-size: 14px;
    }
    
    .jadwal-container {
        grid-template-columns: repeat(2, 1fr);
        bottom: 65px;
        left: 8px;
        right: 8px;
        gap: 6px;
    }
    
    .jadwal-item {
        padding: 12px 8px;
    }
    
    .jadwal-title {
        font-size: 14px;
        margin-bottom: 5px;
    }
    
    .jadwal-time {
        font-size: 22px;
        padding: 3px 6px;
        margin-top: 3px;
        letter-spacing: 1px;
    }
    
    marquee {
        font-size: 12px;
        padding: 6px 0;
    }
}

/* Very small devices (max-width: 400px) */
@media screen and (max-width: 400px) {
    .jadwal-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 5px;
        bottom: 60px;
        left: 5px;
        right: 5px;
    }
    
    .jadwal-item {
        padding: 10px 6px;
    }
    
    .jadwal-title {
        font-size: 13px;
    }
    
    .jadwal-time {
        font-size: 20px;
        padding: 2px 4px;
    }
    
    .countdown-container {
        bottom: 300px;
    }
    
    #jam {
        font-size: 20px;
    }
    
    #tanggal {
        font-size: 13px;
    }
}

/* Landscape mode untuk mobile */
@media screen and (max-height: 600px) and (orientation: landscape) {
    .countdown-container {
        bottom: 120px;
    }
    
    .jadwal-container {
        bottom: 45px;
    }
    
    .jadwal-item {
        padding: 10px 8px;
    }
    
    .jadwal-time {
        font-size: 20px;
    }
}

/* Untuk layar yang sangat pendek */
@media screen and (max-height: 500px) {
    .countdown-container {
        bottom: 100px;
        flex-direction: row;
        justify-content: space-between;
    }
    
    .countdown-ramadhan,
    .countdown-sholat {
        width: 48%;
        max-width: 48%;
        padding: 6px 10px;
    }
    
    .jadwal-container {
        bottom: 40px;
    }
    
    .jadwal-item {
        padding: 8px 5px;
    }
    
    .jadwal-title {
        font-size: 12px;
    }
    
    .jadwal-time {
        font-size: 18px;
    }
}

/* Animasi highlight untuk sholat berikutnya */
.highlight-prayer {
    border: 2px solid #FF7A00 !important;
    box-shadow: 0 0 15px rgba(255, 122, 0, 0.5) !important;
    transform: scale(1.05);
    transition: all 0.3s ease;
}
</style>

</head>

<body style="background-image:url('mekkah1.jpg');">
    <div class="main-container">

    <!-- HEADER -->
    <nav>
        <div class="header-inner">
            <!-- info masjid (KIRI) -->
            <div class="info-masjid">
                <i class="fa-solid fa-mosque"></i>
                <div>
                    <h2>Mesjid Al - Barkah</h2>
                    <small>Jalan Pahlwan, Kampung Tengah, Belakang Polsek Cileungsi.</small>
                </div>
            </div>

            <!-- JAM (KANAN) -->
            <div class="jam-container">
                <div class="jam-wrapper">
                    <div id="jam"></div>
                    <div id="tanggal"></div>
                    <div id="hijri">
                        <span id="tanggal-hijriyah"></span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- COUNTDOWN KIRI-KANAN SIMPEL -->
    <div class="countdown-container">
        <!-- KIRI: RAMADHAN -->
        <div class="countdown-ramadhan">
            <div id="ramadhan"></div>
        </div>
        
        <!-- KANAN: SHOLAT -->
        <div class="countdown-sholat">
            <div id="countSholat"></div>
        </div>
    </div>

    <!-- JADWAL SHOLAT -->
    <div class="jadwal-container">
        <div class="jadwal-item">
            <strong class="jadwal-title">Subuh</strong>
            <strong id="subuh" class="jadwal-time">--:--</strong>
        </div>
        <div class="jadwal-item">
            <strong class="jadwal-title">Syuruk</strong>
            <strong id="syuruq" class="jadwal-time">--:--</strong>
        </div>
        <div class="jadwal-item">
            <strong class="jadwal-title">Dzuhur</strong>
            <strong id="dzuhur" class="jadwal-time">--:--</strong>
        </div>
        <div class="jadwal-item">
            <strong class="jadwal-title">Ashar</strong>
            <strong id="asar" class="jadwal-time">--:--</strong>
        </div>
        <div class="jadwal-item">
            <strong class="jadwal-title">Maghrib</strong>
            <strong id="maghrib" class="jadwal-time">--:--</strong>
        </div>
        <div class="jadwal-item">
            <strong class="jadwal-title">Isya</strong>
            <strong id="isya" class="jadwal-time">--:--</strong>
        </div>
    </div>

    <!-- teks berjalan -->
    <marquee>
        Jadwal kajian Senin: Ust. Fikri - Persiapan Menuju Bulan Suci Ramadhan
    </marquee>
    </div>

<script>
// ==================== KONFIGURASI ====================
const CONFIG = {
    LOCATION_ID: 1206, // ID Kabupaten Bogor untuk Jonggol
    RAMADHAN_DATE: '2026-02-17', // 1 Ramadhan 1447 H
    BACKGROUND_IMAGES: [
        "mekkah1.jpg",
        "mekkah2.jpg"
    ]
};

// ==================== VARIABEL GLOBAL ====================
let currentPrayerTimes = {};
let bgIndex = 0;
let countdownInterval = null;

// ==================== FUNGSI UTAMA ====================

// 1. JAM & TANGGAL REAL-TIME
function updateDateTime() {
    const now = new Date();
    document.getElementById("jam").innerText = now.toLocaleTimeString("id-ID");
    document.getElementById("tanggal").innerText = now.toLocaleDateString("id-ID", {
        weekday: "long",
        day: "numeric",
        month: "long",
        year: "numeric"
    });
}

// 2. AMBIL TANGGAL HIJRIYAH (VERSI YANG BERHASIL)
async function fetchHijriDate() {
    const today = new Date().toISOString().split("T")[0];
    
    try {
        // COBA API PERTAMA
        const response = await fetch(`https://api.myquran.com/v1/hijri/${today}`);
        const data = await response.json();
        
        console.log("Hijri Data:", data); // Untuk debugging
        
        if (data.status === true && data.data) {
            const hijri = data.data;
            document.getElementById("tanggal-hijriyah").innerHTML = 
                `<i class="fas fa-star-and-crescent"></i> ${hijri.date} ${hijri.month.id} ${hijri.year} H`;
            return;
        }
    } catch (error1) {
        console.log("API 1 gagal, coba API 2...");
    }
    
    try {
        // COBA API ALTERNATIF
        const response2 = await fetch(`https://api.aladhan.com/v1/gToH?date=${today}`);
        const data2 = await response2.json();
        
        if (data2.code === 200) {
            const hijri = data2.data.hijri;
            document.getElementById("tanggal-hijriyah").innerHTML = 
                `<i class="fas fa-star-and-crescent"></i> ${hijri.day} ${hijri.month.en} ${hijri.year} H`;
            return;
        }
    } catch (error2) {
        console.log("API 2 juga gagal");
    }
    
    // FALLBACK: Hitung manual
    const hijriDate = calculateHijriDate();
    document.getElementById("tanggal-hijriyah").innerHTML = 
        `${hijriDate}`;
}

// 3. FUNGSI HITUNG MANUAL TANGGAL HIJRIYAH (FALLBACK)
function calculateHijriDate() {
    const today = new Date();
    const startHijri = new Date(2023, 6, 19); // 1 Muharram 1445 H
    const diffDays = Math.floor((today - startHijri) / (1000 * 60 * 60 * 24));
    
    let hijriYear = 1445;
    let daysInYear = 354;
    let remainingDays = diffDays;
    
    while (remainingDays >= daysInYear) {
        remainingDays -= daysInYear;
        hijriYear++;
        // Tahun kabisat Hijriyah (30 tahun cycle)
        daysInYear = (hijriYear % 30 === 2 || hijriYear % 30 === 5 || hijriYear % 30 === 7 || 
                     hijriYear % 30 === 10 || hijriYear % 30 === 13 || hijriYear % 30 === 16 || 
                     hijriYear % 30 === 18 || hijriYear % 30 === 21 || hijriYear % 30 === 24 || 
                     hijriYear % 30 === 26 || hijriYear % 30 === 29) ? 355 : 354;
    }
    
    const hijriMonths = [
        "Muharram", "Safar", "Rabiul Awal", "Rabiul Akhir",
        "Jumadil Awal", "Jumadil Akhir", "Rajab", "Sya'ban",
        "Ramadhan", "Syawal", "Dzulqaidah", "Dzulhijjah"
    ];
    
    const monthDays = [30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29]; // Tahun biasa
    if (daysInYear === 355) monthDays[11] = 30; // Dzulhijjah 30 hari di tahun kabisat
    
    let monthIndex = 0;
    while (remainingDays >= monthDays[monthIndex]) {
        remainingDays -= monthDays[monthIndex];
        monthIndex++;
    }
    
    const hijriDay = remainingDays + 1;
    const hijriMonth = hijriMonths[monthIndex];
    
    return `${hijriDay} ${hijriMonth} ${hijriYear} H`;
}

// 4. AMBIL JADWAL SHOLAT
async function fetchPrayerTimes() {
    const today = new Date().toISOString().split("T")[0];
    
    try {
        const response = await fetch(`https://api.myquran.com/v2/sholat/jadwal/${CONFIG.LOCATION_ID}/${today}`);
        const data = await response.json();
        
        if (data.status && data.data) {
            currentPrayerTimes = data.data.jadwal;
            
            // Update tampilan waktu sholat
            document.getElementById("subuh").innerText = currentPrayerTimes.subuh;
            document.getElementById("syuruq").innerText = currentPrayerTimes.terbit;
            document.getElementById("dzuhur").innerText = currentPrayerTimes.dzuhur;
            document.getElementById("asar").innerText = currentPrayerTimes.ashar;
            document.getElementById("maghrib").innerText = currentPrayerTimes.maghrib;
            document.getElementById("isya").innerText = currentPrayerTimes.isya;
            
            // Mulai countdown
            startCountdown(currentPrayerTimes);
            
            console.log("Jadwal sholat berhasil diambil:", currentPrayerTimes);
            return true;
        }
    } catch (error) {
        console.error("Error mengambil jadwal sholat:", error);
        
        // FALLBACK: Waktu default untuk Jonggol
        const defaultTimes = {
            subuh: "04:30",
            terbit: "05:45",
            dzuhur: "12:00",
            ashar: "15:15",
            maghrib: "18:00",
            isya: "19:15"
        };
        
        document.getElementById("subuh").innerText = defaultTimes.subuh;
        document.getElementById("syuruq").innerText = defaultTimes.terbit;
        document.getElementById("dzuhur").innerText = defaultTimes.dzuhur;
        document.getElementById("asar").innerText = defaultTimes.ashar;
        document.getElementById("maghrib").innerText = defaultTimes.maghrib;
        document.getElementById("isya").innerText = defaultTimes.isya;
        
        startCountdown(defaultTimes);
        return false;
    }
}

// 5. COUNTDOWN SHOLAT TERDEKAT (VERSI OPTIMIZED)
function startCountdown(jadwal) {
    // Hentikan interval sebelumnya jika ada
    if (countdownInterval) {
        clearInterval(countdownInterval);
    }
    
    countdownInterval = setInterval(() => {
        const now = new Date();
        const currentTime = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
        
        // Konversi waktu sholat ke detik
        const prayerSeconds = [
            {name:"Subuh", time:jadwal.subuh},
            {name:"Dzuhur", time:jadwal.dzuhur},
            {name:"Asar", time:jadwal.ashar},
            {name:"Maghrib", time:jadwal.maghrib},
            {name:"Isya", time:jadwal.isya}
        ].map(p => {
            const [hours, minutes] = p.time.split(":").map(Number);
            return {
                name: p.name,
                seconds: hours * 3600 + minutes * 60,
                originalTime: p.time
            };
        });
        
        // Cari sholat berikutnya
        let nextPrayer = null;
        for (let prayer of prayerSeconds) {
            if (prayer.seconds > currentTime) {
                nextPrayer = prayer;
                break;
            }
        }
        
        // Jika tidak ada sholat berikutnya hari ini, gunakan Subuh besok
        if (!nextPrayer) {
            nextPrayer = {
                name: "Subuh",
                seconds: prayerSeconds[0].seconds + 24 * 3600,
                originalTime: jadwal.subuh
            };
        }
        
        // Hitung selisih waktu
        let diffSeconds = nextPrayer.seconds - currentTime;
        if (diffSeconds < 0) diffSeconds += 24 * 3600;
        
        const hours = Math.floor(diffSeconds / 3600);
        const minutes = Math.floor((diffSeconds % 3600) / 60);
        const seconds = diffSeconds % 60;
        
        // Format tampilan countdown
        const countdownElement = document.getElementById("countSholat");
        countdownElement.innerHTML = 
            `<span style="color:white; font-size:24px;">${nextPrayer.name} |</span> ` +
            `<span style="font-family:'DSEG7 Classic', monospace; font-size:28px; margin-left:10px;">` +
            `${hours.toString().padStart(2,'0')}:${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}</span>`;
        
        // Highlight sholat berikutnya di grid
        highlightNextPrayer(nextPrayer.name);
        
    }, 1000); // Update setiap detik
}

// 6. HIGHLIGHT SHOLAT BERIKUTNYA DI GRID
function highlightNextPrayer(prayerName) {
    // Reset semua highlight
    const prayerCards = document.querySelectorAll('[id="subuh"], [id="syuruq"], [id="dzuhur"], [id="asar"], [id="maghrib"], [id="isya"]');
    prayerCards.forEach(card => {
        card.parentElement.style.border = "none";
        card.parentElement.style.boxShadow = "none";
    });
    
    // Highlight sholat berikutnya
    const prayerMap = {
        "Subuh": "subuh",
        "Dzuhur": "dzuhur", 
        "Asar": "asar",
        "Maghrib": "maghrib",
        "Isya": "isya"
    };
    
    if (prayerMap[prayerName]) {
        const nextPrayerElement = document.getElementById(prayerMap[prayerName]);
        if (nextPrayerElement && nextPrayerElement.parentElement) {
            nextPrayerElement.parentElement.style.border = "2px solid #FF7A00";
            nextPrayerElement.parentElement.style.boxShadow = "0 0 15px rgba(255, 122, 0, 0.5)";
        }
    }
}

// 7. COUNTDOWN RAMADHAN YANG DIPERBAIKI
function updateRamadhanCountdown() {
    const ramadhanDate = new Date(CONFIG.RAMADHAN_DATE);
    const now = new Date();
    
    // Jika Ramadhan sudah lewat, hitung untuk tahun depan
    if (now > ramadhanDate) {
        // Tambahkan 354 hari (1 tahun Hijriyah)
        ramadhanDate.setFullYear(ramadhanDate.getFullYear() + 1);
    }
    
    const diffTime = ramadhanDate - now;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    
    // Format tanggal Ramadhan
    const ramadhanFormatted = ramadhanDate.toLocaleDateString('id-ID', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
    });
    
    // Update tampilan
    const ramadhanElement = document.getElementById("ramadhan");
    ramadhanElement.innerHTML = 
        `<strong>${diffDays} Hari</strong> Menuju Bulan Suci Ramadhan<br>`;
    
    return diffDays;
}

// 8. BACKGROUND SLIDER
function initBackgroundSlider() {
    // Preload images
    CONFIG.BACKGROUND_IMAGES.forEach(src => {
        const img = new Image();
        img.src = src;
    });
    
    // Tampilkan gambar pertama
    document.body.style.backgroundImage = `url('${CONFIG.BACKGROUND_IMAGES[0]}')`;
    
    // Ganti otomatis
    setInterval(() => {
        bgIndex = (bgIndex + 1) % CONFIG.BACKGROUND_IMAGES.length;
        document.body.style.backgroundImage = `url('${CONFIG.BACKGROUND_IMAGES[bgIndex]}')`;
        document.body.style.transition = "background-image 1.5s ease-in-out";
    }, 8000);
}

// ==================== INISIALISASI ====================
document.addEventListener("DOMContentLoaded", async function() {
    console.log("Aplikasi Jadwal Sholat Dimulai...");
    
    // 1. Mulai jam & tanggal
    updateDateTime();
    setInterval(updateDateTime, 1000);
    
    // 2. Inisialisasi background slider
    initBackgroundSlider();
    
    // 3. Ambil tanggal Hijriyah
    await fetchHijriDate();
    
    // 4. Ambil jadwal sholat
    await fetchPrayerTimes();
    
    // 5. Mulai countdown Ramadhan
    updateRamadhanCountdown();
    setInterval(updateRamadhanCountdown, 60000); // Update setiap menit
    
    // 6. Refresh data setiap 30 menit
    setInterval(async () => {
        console.log("Refreshing data...");
        await fetchHijriDate();
        await fetchPrayerTimes();
    }, 1800000); // 30 menit
    
    console.log("Aplikasi siap digunakan!");
});

// ==================== ERROR HANDLING ====================
window.addEventListener('error', function(e) {
    console.error("Terjadi error:", e.error);
    
    // Tampilkan pesan error user-friendly
    const errorMsg = "Terjadi kesalahan teknis. Silakan refresh halaman.";
    if (!document.getElementById("error-message")) {
        const errorDiv = document.createElement("div");
        errorDiv.id = "error-message";
        errorDiv.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff4444;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 9999;
            display: none;
        `;
        errorDiv.textContent = errorMsg;
        document.body.appendChild(errorDiv);
        
        setTimeout(() => {
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }, 100);
    }
});

// ==================== FUNGSI TAMBAHAN ====================
// Untuk debugging di console
window.showPrayerTimes = function() {
    console.log("Waktu Sholat Saat Ini:", currentPrayerTimes);
    return currentPrayerTimes;
};

// Cek koneksi internet
window.addEventListener('online', function() {
    console.log("Koneksi internet tersedia, refresh data...");
    fetchHijriDate();
    fetchPrayerTimes();
});

window.addEventListener('offline', function() {
    console.log("Tidak ada koneksi internet");
    document.getElementById("tanggal-hijriyah").innerHTML += " (Offline)";
});
</script>

</body>
</html>
